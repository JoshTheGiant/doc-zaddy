<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Doc Zaddy â€” AI Diagnosis Assistant</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f6f8fa;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    header {
      background: #24292e;
      color: white;
      width: 100%;
      padding: 1rem;
      text-align: center;
      font-size: 1.4rem;
      font-weight: bold;
      letter-spacing: 0.5px;
    }
    main {
      margin-top: 2rem;
      width: 90%;
      max-width: 600px;
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 0.8rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 100%;
      margin-bottom: 1rem;
    }
    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
      border: none;
      transition: 0.2s;
    }
    button:hover { background-color: #0056b3; }
    .results { margin-top: 1.5rem; }
    .disease {
      background: #e9f0ff;
      padding: 0.8rem;
      border-radius: 8px;
      margin-bottom: 0.6rem;
    }
    .confidence {
      color: #333;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>ðŸ©º Doc Zaddy â€” AI Diagnosis Assistant</header>
  <main>
    <p>Enter symptoms separated by commas:</p>
    <input id="symptoms" placeholder="e.g., fever, cough, fatigue" />
    <button onclick="diagnose()">Diagnose</button>

    <div class="results" id="results"></div>
  </main>

  <script>
    // --- Detect backend automatically ---
    const backendBase = `${window.location.protocol}//${window.location.hostname}:8000`;
    console.log("Backend base:", backendBase);

    async function diagnose() {
      const symptoms = document.getElementById('symptoms').value.trim();
      if (!symptoms) return alert('Please enter at least one symptom.');
      
      const url = `${backendBase}/diagnose?symptoms=${encodeURIComponent(symptoms)}&top=5`;
      const res = await fetch(url);
      const data = await res.json();

      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = `<h3>Results (${data.count} matches)</h3>`;
      data.results.forEach(r => {
        const confidence = (r.weighted_score * 50).toFixed(1);
        resultsDiv.innerHTML += `
          <div class="disease">
            <strong>${r.disease}</strong> 
            <span class="confidence">(${confidence}% confidence)</span><br/>
            Matched: ${r.matched}/${r.total_symptoms} symptoms
          </div>`;
      });
    }
  </script>
</body>
</html>
